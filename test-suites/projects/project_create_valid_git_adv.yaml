---
# Validates project creation with valid data.

authors:
  - Intesar Shannan Mohammed

endpoint: /projects/add
method: POST
auth: Default
# Auth required for this endpoint.

# Try using random chars for unique constriants fields.
# Required-fields: name, org_id, description, projectType, url, branch username, password
# Unique Constraints Fields:
# Fields-Constraints
# name: Min 1 char, unique per org_id
# org_id: optional or valid.
# description: optional
# projectType: Optional - LOCAL or GIT, Default: LOCAL
# url - Required if GIT
# branch - Optional
# username - Optional
# password: Optional
# @Response --> {id, name, description, projectType, visibility etc}
requests:
  - '{
        "name": "Test-{{@Random | 6}}",
        "projectType": "GIT",
        "url": "https://github.com/intesar/Fx-Test-Data.git",
        "branch": "",
        "username": "",
        "password": ""
     }'
  - '{
        "name": "Test-{{@Random | 6}}",
        "projectType": "GIT",
        "url": "https://github.com/intesar/Fx-Test-Data.git",
        "branch": "master",
        "username": "",
        "password": ""
     }'
  - '{
        "name": "Test-{{@Random | 6}}",
        "projectType": "GIT",
        "url": "https://github.com/intesar/Fx-Test-Data.git",
        "branch": "master",
        "username": "test",
        "password": ""
     }'
  - '{
        "name": "Test-{{@Random | 6}}",
        "projectType": "GIT",
        "url": "https://github.com/intesar/Fx-Test-Data.git",
        "branch": "master",
        "username": "test",
        "password": "test"
     }'

assertions:
  - "@StatusCode == 200"
  - "@Response.errors == false"
  - "@Response.data.name == @Request.name"
  - "@Response.data.projectType == @Request.projectType"
  - "@Response.data.projectType == GIT"
  - "@Response.data.url == @Request.url"
  - "@Response.data.branch == @Request.branch"
  - "@Response.data.username == @Request.username"


cleanup:
  - project_delete

tags:
  - V1
  - SANDBOX

policies:
  logger: DEBUG
